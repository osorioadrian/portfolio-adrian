---
import { Image } from 'astro:assets';

interface ProjectsText {
  title: string
  client: string
  image: any
  category: string
  tags: string[]
  url: string
  links: LinkInfoText
  showButton: boolean
}

interface LinkInfoText {
  ios: string
  android: string
}

interface ProjectsInfoText {
  title: string
  desc: string
}

interface Props {
  projects: ProjectsText[]
  projectsInfo: ProjectsInfoText
}

const { projects, projectsInfo } = Astro.props
---

<section class="bg-white py-24 px-6 md:px-12 text-black overflow-hidden" id="project">
  <div class="max-w-7xl mx-auto">
    
    <div class="flex flex-col items-center mb-16 text-center">
      <div class="flex items-center gap-2 px-4 py-1.5 rounded-full border border-black/10 bg-[#F9F9F9] text-[10px] uppercase tracking-[0.2em] font-bold mb-6">
        <div class="w-1.5 h-1.5 rounded-full bg-black"></div>
        { projectsInfo.title }
      </div>
      <h2 class="text-4xl md:text-6xl font-medium tracking-tighter text-balance">{projectsInfo.desc}</h2>
    </div>

    <div class="swiper projects-swiper pb-16!">
      <div class="swiper-wrapper">
        {projects.map((project) => (
          <div class="swiper-slide group select-none">
            <div class="relative aspect-4/4 rounded-[2.5rem] overflow-hidden mb-6 bg-gray-50 border border-black/5">
              
              <Image 
                src={project.image} 
                alt={project.title}
                widths={[400, 800]} 
                sizes="(max-width: 768px) 85vw, 400px"
                class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-105 grayscale-[0.5] group-hover:grayscale-0"
              />
              
              <div class="absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition-all duration-500 flex flex-col justify-between p-8">
                
                <div class="flex flex-wrap gap-2">
                  {project.tags?.map((tag) => (
                    <span class="text-[10px] text-white/90 border border-white/20 px-2.5 py-1 rounded-lg uppercase tracking-wider bg-white/10 backdrop-blur-md font-medium">
                      {tag}
                    </span>
                  ))}
                </div>

                <div class="flex flex-col gap-4">
                  <span class="text-white/40 text-[10px] uppercase tracking-[0.3em] font-bold">{project.category}</span>
                  
                  <div class="flex gap-2">
                    {project.links?.ios && (
                      <a href={project.links.ios} target="_blank" class="flex-1 bg-white hover:bg-gray-200 text-black h-12 rounded-2xl flex items-center justify-center transition-colors" aria-label="App Store">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.1 2.48-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.22-1.99 1.08-3.15-1 .04-2.21.67-2.93 1.52-.64.75-1.2 1.94-1.05 3.1 1.12.09 2.26-.64 2.9-1.47z"/></svg>
                      </a>
                    )}
                    {project.links?.android && (
                      <a href={project.links.android} target="_blank" class="flex-1 bg-white hover:bg-gray-200 text-black h-12 rounded-2xl flex items-center justify-center transition-colors" aria-label="Google Play">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3.609 1.814L13.792 12 3.61 22.186a2.29 2.29 0 0 1-.61-1.584V3.4c0-.6.225-1.157.61-1.586zM15.03 13.238l3.126 3.125-14.128 8.146a2.21 2.21 0 0 0 1.34.116l9.662-11.387zm4.79-1.238c0 .33-.09.65-.25.93l-3.66-3.66 3.66-3.66c.16.28.25.6.25.93zM4.03.375a2.21 2.21 0 0 0-1.34.116L16.82 8.638l3.125-3.126L4.03.375z"/></svg>
                      </a>
                    )}
                    {project.url && (
                      <a href={project.url} target="_blank" class="flex-2 bg-white hover:bg-gray-200 text-black h-12 rounded-2xl flex items-center justify-center gap-2 transition-colors px-4" aria-label="Visitar sitio web">
                        <span class="text-[10px] font-bold uppercase tracking-widest">Ver Proyecto</span>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" /></svg>
                      </a>
                    )}
                  </div>
                </div>
              </div>
            </div>
            <div class="flex items-center justify-center gap-2 text-sm">
              <h3 class="font-medium text-black/90">{project.title}</h3>
              <span class="text-gray-400">Para</span>
              <div class="flex items-center gap-1 font-semibold">
                <span class="text-xs tracking-tighter italic">{project.client}</span>
              </div>
            </div>
          </div>
        ))}
      </div>
      <div class="swiper-pagination bottom-0!"></div>
    </div>
  </div>
</section>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script is:inline src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script is:inline>
  new Swiper(".projects-swiper", {
    slidesPerView: 1.2,
    spaceBetween: 20,
    centeredSlides: true,
    loop: true,
    pagination: {
      el: ".swiper-pagination",
      clickable: true,
    },
    breakpoints: {
      768: { slidesPerView: 2, centeredSlides: false, spaceBetween: 30 },
      1024: { slidesPerView: 3, centeredSlides: false, spaceBetween: 40 }
    },
  });
</script>

<style>
  :global(.swiper-pagination-bullet) {
    background: #000 !important;
    opacity: 0.2;
    width: 8px;
    height: 8px;
    margin: 0 12px !important;
    position: relative;
    transition: all 0.3s ease;
  }

  :global(.swiper-pagination-bullet::before) {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 44px;
    height: 44px;
  }

  :global(.swiper-pagination-bullet-active) {
    opacity: 1;
    width: 24px !important;
    border-radius: 4px !important;
  }
</style>